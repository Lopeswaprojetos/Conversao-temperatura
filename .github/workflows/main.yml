name: CI-CD

on:
  push:
    branches: ["main"]
  workflow_dispatch:

jobs:
  CI:
   runs-on: ubuntu-latest
   steps:
    - name: Construir a imagem de container 
       run: echo "executar o docker build"
     - name: Docker Login
       uses: docker/login-action@v3.0.0
       with:
         username: ${{ secrets.DOCKERHUB_USER }}
         password: ${{ secrets.DOCKERHUB_PWD }}
      - name: Condtruir a imagem de container 
       run: echo "executar o docker login"
      - name: Enviar a imagem para o registry
       run: echo "executar o docker push"
    CD:
      runs-on: ubuntu-latest
      needs: [CI]
       steps:
    - name: Autenticar na AWS
       run: echo "Autenticar na AWS"
     - name: Configurar o KubeConfig
       run: echo "Configurar o KubeConfig"
      - name: Aplicar o deploy
       run: echo "Executar o Kubectl apply"
       
